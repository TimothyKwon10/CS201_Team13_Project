<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<title>Everybody's Kitchen | USC Dining Halls</title>
	<link rel="stylesheet" href="EVK.css">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>

<body onload='menuSetup()'>
    <div id="page">
        <header class="header">
            <div class="header-container">
                <div class="left-section">
                    <h1 class="site-title" onclick="navigateTo('home')">USC Dining Halls</h1>
                    <nav class="nav-buttons">
                        <button class="nav-btn" onclick="navigateTo('evk')">EVERYBODY'S KITCHEN</button>
                        <button class="nav-btn" onclick="navigateTo('village')">USC VILLAGE DINING HALL</button>
                        <button class="nav-btn" onclick="navigateTo('parkside')">PARKSIDE KITCHEN AND GRILL</button>
                    </nav>
                </div>
                <div class="auth-buttons">
                    <!-- These buttons will be replaced by userLoginState.js -->
                    <button class="btn-auth">SIGN UP</button>
                    <button class="btn-auth">SIGN IN</button>
                </div>  
            </div>
        </header>
        
        <div id="hero">
            <h1 id = heroText>Everybody's Kitchen</h1>
        </div>
        <div class = "centering">
            <div id = "searchSection">
                <form id = "form">
                    <button type = "submit" class = "searchButton" id = "searchIcon">
                        <i class="fas fa-search"></i>
                    </button>
                    <input type = "search" placeholder = "Search for a meal" id = "searchBar">
                    <button type = "button" class = "searchButton" id = "clearButton">
                        <i class="fas fa-times"></i>
                    </button>
                </form>
                <div id = "dropdown">
                    <!--DROP DOWN MENU GOES HERE-->
                </div>
            </div>
        </div>
        <div class = "centering"> <!--DINING HALL INFO-->
            <div id = "diningHallInfo"> 
                <div id = "leftColumn">
                    <div id = "leftSection">
                        <h1 class = "centering" id  = "descriptionHeader">A Little About EVK</h1>
                        <p> Home style menu served buffet-style format as well as exhibition-style cooking, full salad & sandwich bar (all-you-care-to eat). 
                            Part of the meal plan program, but also open for cash and credit card purchase.<br><br>

                            Located adjacent to Birnkrant and New Residential Colleges, Everybody's Kitchen (EVK) 
                            offers homestyle favorites, made to order action station, pizza, daily grill specials, salad bar, 
                            and dessert station. <br><br>

                            Enjoy monthly theme nights, where we transform the dining room, bring in entertainment and let our 
                            chefs "go all out" with the menu. <br><br>
                            
                            Each residential community is anchored by an all-you-care to eat dining venue. Specific meal plan participants
                            enjoy unlimited access to all three restaurants. Each restaurant offers a different culinary experience appealing 
                            to a variety of dining preferences and nutritional lifestyles of our diverse student population.</p>
                    </div>    
                    
                    <div id="crowdSection">
                        <h1 id="crowdTitle">How Packed Is EVK?</h1>
                        <div id="crowdLVL">
                            <span class="crowdCircle">&#9675;</span>
                            <span class="crowdCircle">&#9675;</span>
                            <span class="crowdCircle">&#9675;</span>
                            <span class="crowdCircle">&#9675;</span>
                            <span class="crowdCircle">&#9675;</span>
                        </div>
                        <p id="crowdDescription">(The dining hall is "moderately busy")</p>
                    </div>
                </div>

                <div id="rightSection">
                    <div id="menu">
                        <h1 class="centering">Today's Menu</h1>
                        <div id="menuEntry">
                            <!-- Menu categories will be populated here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
<div class="centering">
   <div id="reviewContainer">
       <div id="reviewSection">
           <!-- Header with average rating -->
           <div id="reviewHeaderPortion">
               <h1 id="reviewsHeader">Reviews</h1>
               <h1 id="overallRating">0.0</h1> <!-- Will be calculated via JS later -->
           </div>
           <!-- All dynamically loaded reviews will go here -->
           <div id="existingReviews">
				<!-- Will be populated with review data -->
           </div>
           <!-- Form to submit a new review -->
           <div id="reviewFormSection">
               <form class="review-form" id="reviewForm">
                   <textarea id="inputText" placeholder="Share your thoughts about EVK..." required></textarea>
                   <div class="review-form-footer">
                       <div class="rating-select">
                           <div class="hitBox"><span class="reviewStar" data-value="1">&#10084;</span></div>
                           <div class="hitBox"><span class="reviewStar" data-value="2">&#10084;</span></div>
                           <div class="hitBox"><span class="reviewStar" data-value="3">&#10084;</span></div>
                           <div class="hitBox"><span class="reviewStar" data-value="4">&#10084;</span></div>
                           <div class="hitBox"><span class="reviewStar" data-value="5">&#10084;</span></div>
                       </div>
                       <input type="hidden" id="rating" name="rating">
                       <button type="submit" class="submit-review">Submit Review</button>
                   </div>
                   <div id="reviewError" style="display: none; color: red;">Please select a rating.</div>
               </form>
           </div>
       </div>
   </div>
</div>

        <div class = "centering">
            <div id = "imgAndReviews">
                <img src = "../images/evk_food.png" id = "foodIMG">
            </div>
        </div>
        <div id = "bottomSection">
            <h1 id = "bottomHeader">Weekly Menu Calendar</h1>
            <div class="calendar" id="calendar">
                <!-- Calendar will be populated here -->
            </div>
        </div>
    </div>
    <script src = "EVK.js"></script>
    <script src="../userLoginState.js"></script>
    <script>
        function navigateTo(page) {
            if (page === 'home') {
                window.location.href = '../HomePage.html';
            } else if (page === 'evk') {
                window.location.href = '../EVK/EVK.html';
            } else if (page === 'village') {
                window.location.href = '../village/village.html';
            } else if (page === 'parkside') {
                window.location.href = '../parkside/parkside.html';
            }
        }

        // Handle review form display based on login status
        document.addEventListener('DOMContentLoaded', function() {
            const reviewFormSection = document.getElementById('reviewFormSection');
            const isLoggedIn = checkLoginStatus(); // From userLoginState.js

            if (isLoggedIn) {
                reviewFormSection.innerHTML = `
                    <form class="review-form" id="reviewForm">
                        <textarea placeholder="Share your thoughts about EVK..." required></textarea>
                        <div class="review-form-footer">
                            <div class="rating-select">
                                <i class="far fa-heart" data-rating="1"></i>
                                <i class="far fa-heart" data-rating="2"></i>
                                <i class="far fa-heart" data-rating="3"></i>
                                <i class="far fa-heart" data-rating="4"></i>
                                <i class="far fa-heart" data-rating="5"></i>
                            </div>
                            <button type="submit" class="submit-review">Submit Review</button>
                        </div>
                    </form>
                `;

                // Handle rating selection
                const ratingIcons = document.querySelectorAll('.rating-select i');
                ratingIcons.forEach(icon => {
                    icon.addEventListener('click', function() {
                        const rating = this.dataset.rating;
                        ratingIcons.forEach(i => {
                            if (i.dataset.rating <= rating) {
                                i.classList.remove('far');
                                i.classList.add('fas');
                            } else {
                                i.classList.remove('fas');
                                i.classList.add('far');
                            }
                        });
                    });
                });

                // Handle form submission
                document.getElementById('reviewForm').addEventListener('submit', function(e) {
                    e.preventDefault();
                    // Add your review submission logic here
                });
            } else {
                reviewFormSection.innerHTML = `
                    <div class="login-prompt">
                        Please <a href="../loginPage.html">sign in</a> to leave a review
                    </div>
                `;
            }
        });
    </script>
</body>
</html>